<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Manage News</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:Segoe UI,system-ui;
  background:#0f172a;
  color:#fff;
  padding:30px;
}

h2{
  margin-bottom:20px;
}

.card{
  background:#111827;
  padding:15px;
  border-radius:12px;
  margin-bottom:15px;
}

.title{
  font-weight:700;
  margin-bottom:6px;
}

.actions{
  margin-top:10px;
}

button{
  padding:6px 14px;
  border:none;
  border-radius:6px;
  cursor:pointer;
  font-weight:600;
}

.edit{background:#22c55e}
.delete{background:#ef4444;color:#fff}
</style>
</head>

<body>

<h2>ðŸ“° Manage News</h2>
<div id="newsList"></div>

<script>
const token = localStorage.getItem("token");

if(!token){
  alert("Login required");
  location.href = "admin.html";
}

function loadNews(){
  fetch("/api/news/admin",{
    headers:{
      "Authorization":"Bearer "+token
    }
  })
  .then(res => res.json())
  .then(data => {
    const box = document.getElementById("newsList");
    box.innerHTML = "";

    data.forEach(n => {
      const div = document.createElement("div");
      div.className = "card";

      div.innerHTML = `
        <div class="title">${n.title}</div>
        <div>${n.shortDescription || ""}</div>
        <div class="actions">
          <button class="edit" onclick="editNews(${n.id})">Edit</button>
          <button class="delete" onclick="deleteNews(${n.id})">Delete</button>
        </div>
      `;

      box.appendChild(div);
    });
  });
}

function deleteNews(id){
  if(!confirm("Delete this news?")) return;

  fetch(`/api/news/admin/${id}`,{
    method:"DELETE",
    headers:{
      "Authorization":"Bearer "+token
    }
  }).then(()=>{
    loadNews();
  });
}

function editNews(id){
  const title = prompt("New title:");
  const content = prompt("New content:");

  if(!title || !content) return;

  fetch(`/api/news/admin/${id}`,{
    method:"PUT",
    headers:{
      "Content-Type":"application/json",
      "Authorization":"Bearer "+token
    },
    body:JSON.stringify({ title, content })
  }).then(()=>{
    loadNews();
  });
}

loadNews();
</script>

</body>
</html>
