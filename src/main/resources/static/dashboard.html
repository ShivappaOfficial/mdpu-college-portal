<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Dashboard</title>

<!-- Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Icons -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

<!-- Chart -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
    background: linear-gradient(135deg,#0f2027,#203a43,#2c5364);
    min-height:100vh;
    color:#fff;
    font-family: 'Segoe UI', sans-serif;
}

/* Glass Card */
.glass-card{
    background: rgba(255,255,255,0.12);
    backdrop-filter: blur(12px);
    border-radius: 16px;
    padding: 20px;
    box-shadow: 0 15px 30px rgba(0,0,0,.3);
    transition: all .3s ease;
}

.glass-card:hover{
    transform: translateY(-6px);
}

/* Icon */
.stat-icon{
    font-size: 2.2rem;
    padding: 12px;
    border-radius: 50%;
    background: linear-gradient(135deg,#00c6ff,#0072ff);
}

/* Title */
.stat-title{
    font-size: .9rem;
    opacity:.8;
}

.stat-value{
    font-size: 1.8rem;
    font-weight: bold;
}

/* Chart Card */
.chart-card{
    background: rgba(255,255,255,0.12);
    backdrop-filter: blur(14px);
    border-radius: 20px;
    padding: 25px;
    margin-top: 30px;
}
</style>
</head>

<body>

<div class="container py-4">

    <h3 class="mb-4 fw-bold">ðŸ“Š Dashboard Overview</h3>

    <!-- STAT CARDS -->
    <div class="row g-4">

        <div class="col-md-3">
            <div class="glass-card d-flex align-items-center justify-content-between">
                <div>
                    <div class="stat-title">Total Employees</div>
                    <div class="stat-value" id="totalEmployees">0</div>
                </div>
                <div class="stat-icon text-white">
                    <i class="bi bi-people-fill"></i>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="glass-card d-flex align-items-center justify-content-between">
                <div>
                    <div class="stat-title">Total Salary</div>
                    <div class="stat-value">â‚¹ <span id="totalSalary">0</span></div>
                </div>
                <div class="stat-icon text-white">
                    <i class="bi bi-currency-rupee"></i>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="glass-card d-flex align-items-center justify-content-between">
                <div>
                    <div class="stat-title">Developers</div>
                    <div class="stat-value" id="developers">0</div>
                </div>
                <div class="stat-icon text-white">
                    <i class="bi bi-code-slash"></i>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="glass-card d-flex align-items-center justify-content-between">
                <div>
                    <div class="stat-title">Managers</div>
                    <div class="stat-value" id="managers">0</div>
                </div>
                <div class="stat-icon text-white">
                    <i class="bi bi-person-badge-fill"></i>
                </div>
            </div>
        </div>

    </div>

    <!-- CHART -->
    <div class="chart-card">
        <h5 class="mb-3">ðŸ‘¥ Role Distribution</h5>
        <canvas id="roleChart"></canvas>
    </div>

</div>

<script>
const token = localStorage.getItem("token");

fetch("/api/dashboard/stats", {
    headers: { "Authorization": "Bearer " + token }
})
.then(res => res.json())
.then(data => {

    totalEmployees.innerText = data.totalEmployees;
    totalSalary.innerText = data.totalSalary;
    developers.innerText = data.developers;
    managers.innerText = data.managers;

    new Chart(document.getElementById("roleChart"), {
        type: "doughnut",
        data: {
            labels: ["Developers", "Managers"],
            datasets: [{
                data: [data.developers, data.managers],
                backgroundColor: ["#00c6ff","#ff8c00"],
                borderWidth: 0
            }]
        },
        options: {
            plugins: {
                legend: {
                    labels: {
                        color: "#fff"
                    }
                }
            }
        }
    });

});
</script>

</body>
</html>
